<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HerPrayerPlace</title>
  <link rel="icon" type="image/png" href="muslimah.png" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
</head>

<body>
  <!-- Dark Mode Toggle Button -->
  <button id="darkModeToggle" class="dark-mode-toggle float-animation" aria-label="Toggle Dark Mode">
    üåô
  </button>

  <!-- Admin Login Button -->
  <a href="admin.html" class="admin-login-btn" aria-label="Admin Login">
    üîê
  </a>

  <div class="container mx-auto px-4 py-8 max-w-5xl">
    <!-- Header -->
    <div class="glass-card rounded-3xl shadow-2xl p-8 mb-8 transform hover:scale-105 transition-all duration-300">
      <div class="text-center">
        <h1 class="text-5xl md:text-6xl font-extrabold gradient-text mb-3">
          HerPrayerPlace
        </h1>
        <p class="text-gray-600 text-lg md:text-xl font-medium">
          ‚ú® Discover nearby places with female prayer facilities ‚ú®
        </p>
      </div>
    </div>

    <!-- Find Nearby Button -->
    <div class="glass-card rounded-3xl shadow-2xl p-6 mb-8">
      <button id="findNearbyBtn"
        class="w-full gradient-btn pulse-btn text-white font-bold py-4 px-8 rounded-full text-xl shadow-2xl transition duration-300">
        üìç Find Nearby Places
      </button>
      <p id="statusMsg" class="text-sm font-medium mt-3 text-center"></p>
    </div>

    <!-- Map with Slider -->
    <div class="glass-card rounded-3xl shadow-2xl p-6 mb-8">
      <div id="map"></div>
      <!-- Distance Slider Inside Map Section -->
      <div class="distance-slider-compact">
        <span class="distance-label-text">Search Radius:</span>
        <input type="range" id="distanceSlider" min="0.5" max="5" step="0.5" value="1" class="distance-slider" />
        <span class="distance-value-compact"><span id="distanceValue">1</span> km</span>
      </div>
    </div>


    <!-- Search by Location -->
    <div class="glass-card rounded-3xl shadow-2xl p-8 mb-8 search-section">
      <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">
        üîç Find by Location
      </h2>
      <div class="flex flex-col gap-3">
        <div class="suggestions-container">
          <div class="search-input-wrapper">
            <input type="text" id="searchInput" placeholder="Enter location name..." autocomplete="off"
              class="w-full px-6 py-4 pr-14 border-2 border-purple-300 rounded-full focus:outline-none focus:ring-4 focus:ring-purple-400 text-lg font-medium shadow-lg" />
            <button id="clearBtn" class="clear-btn" aria-label="Clear search">‚úï</button>
          </div>
          <div id="suggestionsList" class="suggestions-list"></div>
        </div>
        <button id="searchBtn"
          class="search-btn text-white font-bold px-8 py-4 rounded-full text-lg shadow-lg w-full sm:w-auto">
          Search Now
        </button>
        <button id="viewAllMosquesBtn"
          class="gradient-btn text-white font-bold px-8 py-4 rounded-full text-lg shadow-lg w-full sm:w-auto">
          View all the places
        </button>
      </div>
    </div>

    <!-- Legend -->
    <!-- <div class="glass-card rounded-3xl shadow-2xl p-8">
      <h3 class="text-3xl font-bold text-gray-800 mb-6 text-center">üìå Legend</h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="legend-item flex items-center gap-3">
          <img src="pin (1).png" class="legend-icon" alt="Your Location" />
          <span class="text-sm md:text-base font-semibold text-gray-700">Your Location</span>
        </div>
        <div class="legend-item flex items-center gap-3">
          <img src="pin.png" class="legend-icon" alt="Nearby Mosques" />
          <span class="text-sm md:text-base font-semibold text-gray-700">Within Radius</span>
        </div>
        <div class="legend-item flex items-center gap-3">
          <img src="pin (2).png" class="legend-icon" alt="All Mosques" />
          <span class="text-sm md:text-base font-semibold text-gray-700">All Mosques</span>
        </div>
      </div>
    </div> -->


    <!-- Suggest New Places Banner -->
    <div class="glass-card rounded-3xl shadow-2xl p-6 mb-8 suggest-banner">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div class="flex items-center gap-4">
          <div class="suggest-icon">‚ú®</div>
          <div>
            <h3 class="text-xl font-bold text-gray-800 mb-1">Know a Place We're Missing?</h3>
            <p class="text-sm text-gray-600">Help other sisters by suggesting new locations!</p>
          </div>
        </div>
        <a href="https://forms.gle/jp5V7YSX4GH7Gwpt6"
          class="suggest-banner-btn">
          Suggest Now
        </a>
      </div>
    </div>

  </div>


  <!-- Mosque List Modal -->
  <div id="mosqueModal" class="mosque-modal">
    <div class="mosque-modal-content">
      <div class="mosque-modal-header">
        <div>
          <h2 class="mosque-modal-title">
            üïå All Female Prayer Places
          </h2>
          <span class="mosque-count" id="mosqueCount">0 Places</span>
        </div>
        <button id="closeMosqueModal" class="mosque-modal-close" aria-label="Close modal">‚úï</button>
      </div>
      <div class="mosque-modal-body" id="mosqueListContainer">
        <!-- Mosque list will be populated here -->
      </div>
    </div>
  </div>

  <!-- Suggestion Popup Modal -->
  <div id="suggestionPopup" class="suggestion-popup">
    <div class="suggestion-popup-content">
      <button id="closeSuggestionPopup" class="suggestion-popup-close" aria-label="Close">‚úï</button>
      <div class="suggestion-popup-icon">‚ú®</div>
      <h3 class="suggestion-popup-title">Help Us Grow!</h3>
      <p class="suggestion-popup-text">Know a place with female prayer facilities that we're missing? Your contribution helps thousands of sisters!</p>
      <div class="suggestion-popup-buttons">
        <a href="https://forms.gle/jp5V7YSX4GH7Gwpt6" class="suggestion-popup-btn-primary">
          ‚ûï Suggest a Place
        </a>
        <button id="maybeLaterBtn" class="suggestion-popup-btn-secondary">
          Maybe Later
        </button>
      </div>
    </div>
  </div>

  <script src="main.js"></script>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyALo1YQ2M1GeoH9mORVV7dYSOl2FSCTc84",
      authDomain: "herprayerplace.firebaseapp.com",
      projectId: "herprayerplace",
      storageBucket: "herprayerplace.firebasestorage.app",
      messagingSenderId: "956020903317",
      appId: "1:956020903317:web:030c848fbaa10d3e86ba9c"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function loadMosques() {
      try {
        const querySnapshot = await getDocs(collection(db, 'mosques'));
        window.mosqueLocations = [];
        querySnapshot.forEach((doc) => {
          const data = doc.data();
          window.mosqueLocations.push({
            name: data.name,
            lat: data.lat,
            lng: data.lng
          });
        });

        console.log('Loaded mosques:', window.mosqueLocations.length);

        // Call display functions after a brief delay to ensure map is ready
        // setTimeout(() => {
        //   if (window.displayMosques) {
        //     window.displayMosques();
        //   }
        //   if (window.populateMosqueList) {
        //     window.populateMosqueList();
        //   }
        // }, 100);

        if (window.displayMosques) {
            window.displayMosques();
          }
          if (window.populateMosqueList) {
            window.populateMosqueList();
          }

      } catch (error) {
        console.error('Error loading mosques:', error);
      }
    }

    loadMosques();
  </script>



</body>

</html>